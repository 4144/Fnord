language: python
python:
  - 3.5
  - 3.6
  - 3.7-dev
cache: pip
before_install:
  - sudo apt-get update
  - sudo apt-get install -y yara
install:
  - pip install -r requirements.txt

script:
  - yara --version
  - python fnord.py
  - python fnord.py -f ./test/launch-varplus.txt --noyara
  - ! cat fnord-rules.yar
  - python fnord.py -f ./test/vbs.txt --show-score --show-count
  - fgrep "(1* 2^0 )" fnord-rules.yar -c
  - egrep "WScript" fnord-rules.yar -c
  - yara -r fnord-rules.yar ./test
  - fnord.py -f ./test/inv-obf.txt --show-score --show-count -t 1 --yara-strings 4 --yara-exact
  - fgrep "^'^2^+^2^" fnord-rules.yar -c
  - fgrep "(^S^e^T ^ ^" fnord-rules.yar -c
  - fgrep " ( ; ; ; (" fnord-rules.yar -c
  - yara -r fnord-rules.yar ./test
  - python fnord.py -f ./test/wraeop.sct
  - fgrep ",101," fnord-rules.yar -c
  - fgrep "temp%/VRE" fnord-rules.yar -c
  - yara -r fnord-rules.yar ./test

notifications:
  email:
    recipients:
      - venom14@gmail.com
    on_success: always
    on_failure: always
